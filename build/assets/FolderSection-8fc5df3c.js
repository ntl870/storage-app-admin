import{r as s,A as ne,_ as L,bj as Se,bk as Ie,bl as we,bm as z,t as ke,v as De,aq as xe,w as Q,bn as ie,y as Z,bo as Re,bp as Oe,b7 as $e,H as le,bq as Me,aO as Fe,aL as Ee,br as Te,a as i,u as P,bs as Be,bt as Pe,bu as Ue,bv as Ne,D as K,B,j as $,bw as se,bx as ze,by as Le,bz as Ae,bA as je,R as ce,C as q,ac as de,bB as Ge,P as ue,K as he,bC as _e,bD as He,F as U,T as N,n as _,p as H,o as W,bE as We,N as Ve,O as Qe,W as qe,af as Xe,bF as Ze,bG as Ke,bH as Je,bI as Ye,bJ as eo,m as oo,a5 as to,ak as ao,al as te,am as ro,an as no}from"./index-18d7895e.js";import{m as X}from"./index-aa80ddb7.js";import{F as io,a as lo,c as so}from"./index.es-f03b9607.js";import{s as co}from"./styled-components.browser.esm-08fa7367.js";import{a as uo,S as J,D as be,L as E,F as ho}from"./index-5b4eb152.js";import{M as j}from"./index-8250cea1.js";import{E as bo}from"./index-9ad78b7b.js";import{D as fo}from"./DeleteOutlined-725f5558.js";var go={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M624 706.3h-74.1V464c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v242.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.7a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-download",theme:"outlined"};const mo=go;var fe=function(r,n){return s.createElement(ne,L(L({},r),{},{ref:n,icon:mo}))};fe.displayName="CloudDownloadOutlined";const po=s.forwardRef(fe);var yo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z"}}]},name:"link",theme:"outlined"};const vo=yo;var ge=function(r,n){return s.createElement(ne,L(L({},r),{},{ref:n,icon:vo}))};ge.displayName="LinkOutlined";const Co=s.forwardRef(ge);var So=["refetch","reobserve","fetchMore","updateQuery","startPolling","subscribeToMore"];function Io(a,r){var n,o=s.useRef(new Set),e=s.useRef(),g=e.current?Se(r,e.current):r,f=Ie(we(r&&r.client),(n=g==null?void 0:g.query)!==null&&n!==void 0?n:a),b=f.useQuery(z(z({},g),{skip:!e.current})),l=b.observable.options.initialFetchPolicy||f.getDefaultFetchPolicy(),v=Object.assign(b,{called:!!e.current}),h=s.useMemo(function(){for(var d={},m=function(u){var x=v[u];d[u]=function(){return e.current||(e.current=Object.create(null),f.forceUpdate()),x.apply(this,arguments)}},S=0,D=So;S<D.length;S++){var y=D[S];m(y)}return d},[]);Object.assign(v,h),s.useEffect(function(){return function(){o.current.forEach(function(d){d.abort()})}},[]);var I=s.useCallback(function(d){var m=new AbortController;o.current.add(m),e.current=d?z(z({},d),{fetchPolicy:d.fetchPolicy||l}):{fetchPolicy:l};var S=f.asyncUpdate(m.signal).then(function(D){return o.current.delete(m),Object.assign(D,h)});return S.catch(function(){o.current.delete(m)}),S},[]);return[I,v]}const wo=new xe("antRadioEffect",{"0%":{transform:"scale(1)",opacity:.5},"100%":{transform:"scale(1.6)",opacity:0}}),ko=a=>{const{componentCls:r,antCls:n}=a,o=`${r}-group`;return{[o]:Object.assign(Object.assign({},Q(a)),{display:"inline-block",fontSize:0,[`&${o}-rtl`]:{direction:"rtl"},[`${n}-badge ${n}-badge-count`]:{zIndex:1},[`> ${n}-badge:not(:first-child) > ${n}-button-wrapper`]:{borderInlineStart:"none"}})}},Do=a=>{const{componentCls:r,radioWrapperMarginRight:n,radioCheckedColor:o,radioSize:e,motionDurationSlow:g,motionDurationMid:f,motionEaseInOut:b,motionEaseInOutCirc:l,radioButtonBg:v,colorBorder:h,lineWidth:I,radioDotSize:d,colorBgContainerDisabled:m,colorTextDisabled:S,paddingXS:D,radioDotDisabledColor:y,lineType:u,radioDotDisabledSize:x,wireframe:t,colorWhite:R}=a,C=`${r}-inner`;return{[`${r}-wrapper`]:Object.assign(Object.assign({},Q(a)),{position:"relative",display:"inline-flex",alignItems:"baseline",marginInlineStart:0,marginInlineEnd:n,cursor:"pointer",[`&${r}-wrapper-rtl`]:{direction:"rtl"},"&-disabled":{cursor:"not-allowed",color:a.colorTextDisabled},"&::after":{display:"inline-block",width:0,overflow:"hidden",content:'"\\a0"'},[`${r}-checked::after`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:"100%",height:"100%",border:`${I}px ${u} ${o}`,borderRadius:"50%",visibility:"hidden",animationName:wo,animationDuration:g,animationTimingFunction:b,animationFillMode:"both",content:'""'},[r]:Object.assign(Object.assign({},Q(a)),{position:"relative",display:"inline-block",outline:"none",cursor:"pointer",alignSelf:"center"}),[`${r}-wrapper:hover &,
        &:hover ${C}`]:{borderColor:o},[`${r}-input:focus-visible + ${C}`]:Object.assign({},ie(a)),[`${r}:hover::after, ${r}-wrapper:hover &::after`]:{visibility:"visible"},[`${r}-inner`]:{"&::after":{boxSizing:"border-box",position:"absolute",insetBlockStart:"50%",insetInlineStart:"50%",display:"block",width:e,height:e,marginBlockStart:e/-2,marginInlineStart:e/-2,backgroundColor:t?o:R,borderBlockStart:0,borderInlineStart:0,borderRadius:e,transform:"scale(0)",opacity:0,transition:`all ${g} ${l}`,content:'""'},boxSizing:"border-box",position:"relative",insetBlockStart:0,insetInlineStart:0,display:"block",width:e,height:e,backgroundColor:v,borderColor:h,borderStyle:"solid",borderWidth:I,borderRadius:"50%",transition:`all ${f}`},[`${r}-input`]:{position:"absolute",insetBlockStart:0,insetInlineEnd:0,insetBlockEnd:0,insetInlineStart:0,zIndex:1,cursor:"pointer",opacity:0},[`${r}-checked`]:{[C]:{borderColor:o,backgroundColor:t?v:o,"&::after":{transform:`scale(${d/e})`,opacity:1,transition:`all ${g} ${l}`}}},[`${r}-disabled`]:{cursor:"not-allowed",[C]:{backgroundColor:m,borderColor:h,cursor:"not-allowed","&::after":{backgroundColor:y}},[`${r}-input`]:{cursor:"not-allowed"},[`${r}-disabled + span`]:{color:S,cursor:"not-allowed"},[`&${r}-checked`]:{[C]:{"&::after":{transform:`scale(${x/e})`}}}},[`span${r} + *`]:{paddingInlineStart:D,paddingInlineEnd:D}})}},xo=a=>{const{radioButtonColor:r,controlHeight:n,componentCls:o,lineWidth:e,lineType:g,colorBorder:f,motionDurationSlow:b,motionDurationMid:l,radioButtonPaddingHorizontal:v,fontSize:h,radioButtonBg:I,fontSizeLG:d,controlHeightLG:m,controlHeightSM:S,paddingXS:D,borderRadius:y,borderRadiusSM:u,borderRadiusLG:x,radioCheckedColor:t,radioButtonCheckedBg:R,radioButtonHoverColor:C,radioButtonActiveColor:c,radioSolidCheckedColor:p,colorTextDisabled:F,colorBgContainerDisabled:M,radioDisabledButtonCheckedColor:w,radioDisabledButtonCheckedBg:k}=a;return{[`${o}-button-wrapper`]:{position:"relative",display:"inline-block",height:n,margin:0,paddingInline:v,paddingBlock:0,color:r,fontSize:h,lineHeight:`${n-e*2}px`,background:I,border:`${e}px ${g} ${f}`,borderBlockStartWidth:e+.02,borderInlineStartWidth:0,borderInlineEndWidth:e,cursor:"pointer",transition:[`color ${l}`,`background ${l}`,`border-color ${l}`,`box-shadow ${l}`].join(","),a:{color:r},[`> ${o}-button`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,zIndex:-1,width:"100%",height:"100%"},"&:not(:first-child)":{"&::before":{position:"absolute",insetBlockStart:-e,insetInlineStart:-e,display:"block",boxSizing:"content-box",width:1,height:"100%",paddingBlock:e,paddingInline:0,backgroundColor:f,transition:`background-color ${b}`,content:'""'}},"&:first-child":{borderInlineStart:`${e}px ${g} ${f}`,borderStartStartRadius:y,borderEndStartRadius:y},"&:last-child":{borderStartEndRadius:y,borderEndEndRadius:y},"&:first-child:last-child":{borderRadius:y},[`${o}-group-large &`]:{height:m,fontSize:d,lineHeight:`${m-e*2}px`,"&:first-child":{borderStartStartRadius:x,borderEndStartRadius:x},"&:last-child":{borderStartEndRadius:x,borderEndEndRadius:x}},[`${o}-group-small &`]:{height:S,paddingInline:D-e,paddingBlock:0,lineHeight:`${S-e*2}px`,"&:first-child":{borderStartStartRadius:u,borderEndStartRadius:u},"&:last-child":{borderStartEndRadius:u,borderEndEndRadius:u}},"&:hover":{position:"relative",color:t},"&:has(:focus-visible)":Object.assign({},ie(a)),[`${o}-inner, input[type='checkbox'], input[type='radio']`]:{width:0,height:0,opacity:0,pointerEvents:"none"},[`&-checked:not(${o}-button-wrapper-disabled)`]:{zIndex:1,color:t,background:R,borderColor:t,"&::before":{backgroundColor:t},"&:first-child":{borderColor:t},"&:hover":{color:C,borderColor:C,"&::before":{backgroundColor:C}},"&:active":{color:c,borderColor:c,"&::before":{backgroundColor:c}}},[`${o}-group-solid &-checked:not(${o}-button-wrapper-disabled)`]:{color:p,background:t,borderColor:t,"&:hover":{color:p,background:C,borderColor:C},"&:active":{color:p,background:c,borderColor:c}},"&-disabled":{color:F,backgroundColor:M,borderColor:f,cursor:"not-allowed","&:first-child, &:hover":{color:F,backgroundColor:M,borderColor:f}},[`&-disabled${o}-button-wrapper-checked`]:{color:w,backgroundColor:k,borderColor:f,boxShadow:"none"}}}},me=ke("Radio",a=>{const{padding:r,lineWidth:n,controlItemBgActiveDisabled:o,colorTextDisabled:e,colorBgContainer:g,fontSizeLG:f,controlOutline:b,colorPrimaryHover:l,colorPrimaryActive:v,colorText:h,colorPrimary:I,marginXS:d,controlOutlineWidth:m,colorTextLightSolid:S,wireframe:D}=a,y=`0 0 0 ${m}px ${b}`,u=y,x=f,t=4,R=x-t*2,C=D?R:x-(t+n)*2,c=I,p=h,F=l,M=v,w=r-n,O=De(a,{radioFocusShadow:y,radioButtonFocusShadow:u,radioSize:x,radioDotSize:C,radioDotDisabledSize:R,radioCheckedColor:c,radioDotDisabledColor:e,radioSolidCheckedColor:S,radioButtonBg:g,radioButtonCheckedBg:g,radioButtonColor:p,radioButtonHoverColor:F,radioButtonActiveColor:M,radioButtonPaddingHorizontal:w,radioDisabledButtonCheckedBg:o,radioDisabledButtonCheckedColor:e,radioWrapperMarginRight:d});return[ko(O),Do(O),xo(O)]});function Ro(a){return Object.keys(a).reduce((r,n)=>((n.startsWith("data-")||n.startsWith("aria-")||n==="role")&&!n.startsWith("data-__")&&(r[n]=a[n]),r),{})}const pe=s.createContext(null),Oo=pe.Provider,ye=s.createContext(null),$o=ye.Provider;var Mo=globalThis&&globalThis.__rest||function(a,r){var n={};for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&r.indexOf(o)<0&&(n[o]=a[o]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var e=0,o=Object.getOwnPropertySymbols(a);e<o.length;e++)r.indexOf(o[e])<0&&Object.prototype.propertyIsEnumerable.call(a,o[e])&&(n[o[e]]=a[o[e]]);return n};const Fo=(a,r)=>{var n,o;const e=s.useContext(pe),g=s.useContext(ye),{getPrefixCls:f,direction:b}=s.useContext(Z),l=s.useRef(),v=Re(r,l),{isFormItemInput:h}=s.useContext(Oe),I=M=>{var w,k;(w=a.onChange)===null||w===void 0||w.call(a,M),(k=e==null?void 0:e.onChange)===null||k===void 0||k.call(e,M)},{prefixCls:d,className:m,rootClassName:S,children:D,style:y}=a,u=Mo(a,["prefixCls","className","rootClassName","children","style"]),x=f("radio",d),t=((e==null?void 0:e.optionType)||g)==="button"?`${x}-button`:x,[R,C]=me(x),c=Object.assign({},u),p=s.useContext($e);e&&(c.name=e.name,c.onChange=I,c.checked=a.value===e.value,c.disabled=(n=c.disabled)!==null&&n!==void 0?n:e.disabled),c.disabled=(o=c.disabled)!==null&&o!==void 0?o:p;const F=le(`${t}-wrapper`,{[`${t}-wrapper-checked`]:c.checked,[`${t}-wrapper-disabled`]:c.disabled,[`${t}-wrapper-rtl`]:b==="rtl",[`${t}-wrapper-in-form-item`]:h},m,S,C);return R(s.createElement("label",{className:F,style:y,onMouseEnter:a.onMouseEnter,onMouseLeave:a.onMouseLeave},s.createElement(Me,Object.assign({},c,{type:"radio",prefixCls:t,ref:v})),D!==void 0?s.createElement("span",null,D):null))},Eo=s.forwardRef(Fo),A=Eo,To=s.forwardRef((a,r)=>{const{getPrefixCls:n,direction:o}=s.useContext(Z),e=s.useContext(Fe),[g,f]=Ee(a.defaultValue,{value:a.value}),b=O=>{const Ce=g,ee=O.target.value;"value"in a||f(ee);const{onChange:oe}=a;oe&&ee!==Ce&&oe(O)},{prefixCls:l,className:v,rootClassName:h,options:I,buttonStyle:d="outline",disabled:m,children:S,size:D,style:y,id:u,onMouseEnter:x,onMouseLeave:t,onFocus:R,onBlur:C}=a,c=n("radio",l),p=`${c}-group`,[F,M]=me(c);let w=S;I&&I.length>0&&(w=I.map(O=>typeof O=="string"||typeof O=="number"?s.createElement(A,{key:O.toString(),prefixCls:c,disabled:m,value:O,checked:g===O},O):s.createElement(A,{key:`radio-group-value-options-${O.value}`,prefixCls:c,disabled:O.disabled||m,value:O.value,checked:g===O.value,style:O.style},O.label)));const k=D||e,Y=le(p,`${p}-${d}`,{[`${p}-${k}`]:k,[`${p}-rtl`]:o==="rtl"},v,h,M);return F(s.createElement("div",Object.assign({},Ro(a),{className:Y,style:y,onMouseEnter:x,onMouseLeave:t,onFocus:R,onBlur:C,id:u,ref:r}),s.createElement(Oo,{value:{onChange:b,value:g,disabled:a.disabled,name:a.name,optionType:a.optionType}},w)))}),Bo=s.memo(To);var Po=globalThis&&globalThis.__rest||function(a,r){var n={};for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&r.indexOf(o)<0&&(n[o]=a[o]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var e=0,o=Object.getOwnPropertySymbols(a);e<o.length;e++)r.indexOf(o[e])<0&&Object.prototype.propertyIsEnumerable.call(a,o[e])&&(n[o[e]]=a[o[e]]);return n};const Uo=(a,r)=>{const{getPrefixCls:n}=s.useContext(Z),{prefixCls:o}=a,e=Po(a,["prefixCls"]),g=n("radio",o);return s.createElement($o,{value:"button"},s.createElement(A,Object.assign({prefixCls:g},e,{type:"radio",ref:r})))},No=s.forwardRef(Uo),G=A;G.Button=No;G.Group=Bo;G.__ANT_RADIO=!0;const V=G,ae={page:1,limit:20},ve=({debounceTimeout:a=800,query:r,format:n,queryOptionsVariables:o,onChange:e,multiple:g,...f})=>{const[b,l]=s.useState([]),[v,h]=s.useState(!1),[I,d]=s.useState(ae),[m,S]=s.useState(!0),[D]=Io(r),[y,u]=s.useState(""),x=C=>{D({variables:o?{...o,search:C,...I}:{search:C,...I},fetchPolicy:"cache-and-network"}).then(c=>{var F,M,w;const p=Object.keys(c.data)[0];l((M=(F=c.data[p])==null?void 0:F.results)==null?void 0:M.map(n)),S((w=c.data[p])==null?void 0:w.hasMore)}).finally(()=>{h(!1)})},t=s.useMemo(()=>(d(ae),S(!0),Te(c=>{h(!0),l([]),x(c)},a)),[a]),R=C=>{const c=C.target;c.scrollTop+c.offsetHeight===c.scrollHeight&&m&&d(p=>({...p,page:p.page+1}))};return s.useEffect(()=>{(async()=>{m&&!v&&(h(!0),x(y))})()},[I.page]),i(uo,{className:"w-full",labelInValue:!0,filterOption:!1,onSearch:C=>{u(C),t(C)},onChange:C=>{e==null||e(C)},showSearch:!0,allowClear:!0,autoClearSearchValue:!0,onPopupScroll:R,notFoundContent:v?i(J,{size:"small"}):i(bo,{}),loading:v,...f,options:b,mode:g?"multiple":void 0})};var T=(a=>(a.EDITOR="Editor",a.VIEWER="Viewer",a))(T||{});const re=({userID:a,initialRole:r,ID:n,type:o,refetchAccessPeople:e})=>{const{showErrorNotification:g,showSuccessNotification:f}=P(),[b,l]=s.useState(r),[v]=Be(),[h]=Pe(),[I]=Ue(),[d]=Ne(),m=async y=>{try{if(o==="folder"){const{data:u}=await v({variables:{targetUserID:a,targetRole:y,folderID:n}});e(),f((u==null?void 0:u.changeUserRoleInFolder)||"")}if(o==="file"){const{data:u}=await h({variables:{targetUserID:a,targetRole:y,fileID:n}});e(),f((u==null?void 0:u.changeUserRoleInFile)||"")}}catch(u){g(u.message)}};return i(K,{menu:{items:[{label:"Editor",key:"0",onClick:async()=>{b!==T.EDITOR&&(l(T.EDITOR),await m(T.EDITOR))}},{label:"Viewer",key:"1",onClick:async()=>{b!==T.VIEWER&&(l(T.VIEWER),await m(T.VIEWER))}},{label:"Remove Access",key:"2",onClick:async()=>{try{if(o==="folder"){const{data:y}=await I({variables:{targetUserID:a,folderID:n}});e(),f((y==null?void 0:y.removeUserFromFolder)||"")}if(o==="file"){const{data:y}=await d({variables:{targetUserID:a,fileID:n}});e(),f((y==null?void 0:y.removeUserFromFile)||"")}}catch(y){g(y.message)}}}]},trigger:["click"],children:i(B,{children:$(se,{children:[b,i(be,{})]})})})},zo=({open:a,handleClose:r,initialUser:n,ID:o,refetchAccessPeople:e,type:g})=>{const{showErrorNotification:f,showSuccessNotification:b}=P(),[l,v]=s.useState("Editor"),[h,I]=s.useState(n),[d,m]=s.useState(!1),[S,D]=s.useState(""),[y]=ze(),[u]=Le(),[x]=Ae(),[t]=je(),R=[{label:"Editor",key:"0",onClick:()=>v("Editor")},{label:"Viewer",key:"1",onClick:()=>v("Viewer")}],C=async()=>{try{const w=Array.isArray(h)?h.map(k=>k.value):[String(h==null?void 0:h.value)];if(g==="folder"){const{data:k}=await y({variables:{folderID:o,sharedUserIDs:w,shouldSendMail:d,userMessage:S}});b((k==null?void 0:k.addSharedUserToFolder)||""),e()}if(g==="file"){const{data:k}=await x({variables:{fileID:o,sharedUserIDs:w,shouldSendMail:d,userMessage:S}});b((k==null?void 0:k.addUsersToSharedUserFile)||""),e()}}catch(w){f(w.message)}finally{r()}},c=async()=>{try{const w=Array.isArray(h)?h.map(k=>k.value):[String(h==null?void 0:h.value)];if(g==="folder"){const{data:k}=await u({variables:{folderID:o,readOnlyUserIDs:w,shouldSendMail:d,userMessage:S}});b((k==null?void 0:k.addUserToFolderReadOnlyUsers)||""),e()}if(g==="file"){const{data:k}=await t({variables:{fileID:o,readonlyUserIDs:w,shouldSendMail:d,userMessage:S}});b((k==null?void 0:k.addUsersToReadonlyFile)||""),e()}}catch(w){f(w.message)}finally{r()}},p=()=>{l==="Editor"&&C(),l==="Viewer"&&c()},F=w=>{m(w.target.checked)},M=w=>{D(w.target.value)};return $(j,{title:"Add User",open:a,onCancel:r,centered:!0,onOk:p,children:[$(ce,{gutter:[16,16],children:[i(q,{span:18,children:i(ve,{query:de,multiple:!0,format:w=>({label:`${w.name} - ${w.email}`,value:w.ID}),onChange:I,value:h})}),i(q,{span:4,children:i(K,{menu:{items:R},trigger:["click"],children:i(B,{children:$(se,{children:[l,i(be,{})]})})})})]}),i(Ge,{onChange:F,className:"my-4",children:"Notify user via email"}),i(ue.TextArea,{placeholder:"Add a message",onChange:M})]})},Lo=({open:a,handleClose:r,folder:n})=>{const{ID:o}=he(),{showErrorNotification:e,showSuccessNotification:g}=P(),[f,b]=s.useState(null),[l,v]=s.useState("Private"),[h,{loading:I}]=_e(),{data:d,refetch:m,loading:S}=He({variables:{folderID:n.ID},onCompleted:t=>{v(t.getPeopleWithAccessToFolder.isPublic?"Public":"Private")},fetchPolicy:"cache-and-network"}),D=()=>{b(null)},y=async t=>{if(v(t),t==="Private")try{await h({variables:{folderID:n.ID,isPublic:!1}}),g("Folder access changed to private"),v("Private"),m()}catch(R){e(R.message)}if(t==="Public")try{await h({variables:{folderID:n.ID,isPublic:!0}}),g("Folder access changed to public"),v("Public"),m()}catch(R){e(R.message)}},u=s.useMemo(()=>o===(d==null?void 0:d.getPeopleWithAccessToFolder.owner.ID)||(d==null?void 0:d.getPeopleWithAccessToFolder.sharedUsers.some(t=>String(t.ID)===o)),[d,o]);return $(U,{children:[i(j,{okButtonProps:{hidden:!0},centered:!0,open:a,title:"Share folder",cancelText:"Close",footer:$(U,{children:[i(B,{icon:i(Co,{}),onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/folder/${n.ID}`),X.success("Link copied to clipboard")},children:"Copy link"},"copy"),i(B,{type:"primary",onClick:r,children:"Done"},"done")]}),children:S||I?i("div",{className:"text-center",children:i(J,{})}):$(U,{children:[u&&i(ve,{query:de,format:t=>({label:`${t.name} - ${t.email}`,value:t.ID}),onChange:b}),$("div",{className:"mt-4",children:[i(N.Text,{className:"font-bold",children:"Users can modify"}),(()=>{const t=d==null?void 0:d.getPeopleWithAccessToFolder.owner;return i(E,{children:$(E.Item,{children:[i(E.Item.Meta,{avatar:i(_,{size:"large",src:t!=null&&t.avatar?W(t.avatar):H(String(t==null?void 0:t.ID))}),title:t==null?void 0:t.name,description:t==null?void 0:t.email}),i(N.Text,{italic:!0,type:"secondary",className:"text-lg",children:"Owner"})]})})})(),i(E,{itemLayout:"horizontal",className:"max-h-96 overflow-y-auto",dataSource:d==null?void 0:d.getPeopleWithAccessToFolder.sharedUsers.filter(t=>t.ID!==d.getPeopleWithAccessToFolder.owner.ID),locale:{emptyText:" "},renderItem:t=>i(U,{children:$(E.Item,{children:[i(E.Item.Meta,{avatar:i(_,{size:"large",src:t!=null&&t.avatar?W(t.avatar):H(String(t==null?void 0:t.ID))}),title:t==null?void 0:t.name,description:t==null?void 0:t.email}),u&&i(re,{initialRole:T.EDITOR,userID:(t==null?void 0:t.ID)||"",ID:n.ID,type:"folder",refetchAccessPeople:m})]})})})]}),$("div",{children:[i(N.Text,{className:"font-bold",children:"Users can view"}),i(E,{itemLayout:"horizontal",className:"max-h-96 overflow-y-auto",dataSource:d==null?void 0:d.getPeopleWithAccessToFolder.readonlyUsers,renderItem:t=>$(E.Item,{children:[i(E.Item.Meta,{avatar:i(_,{size:"large",src:t.avatar?W(t.avatar):H(String(t.ID))}),title:t.name,description:t.email}),u&&i(re,{initialRole:T.VIEWER,userID:t.ID,ID:n.ID,type:"folder",refetchAccessPeople:m})]})})]}),$("div",{className:"flex flex-col",children:[i(N.Text,{className:"font-bold",children:"General Access"}),$(V.Group,{onChange:t=>y(t.target.value),value:l,buttonStyle:"solid",disabled:!u,children:[i(V.Button,{value:"Public",className:"w-1/2 text-center",children:"Public"}),i(V.Button,{value:"Private",className:"w-1/2 text-center",children:"Private"})]})]})]})}),!!f&&i(zo,{type:"folder",open:!!f,initialUser:f,handleClose:D,ID:n.ID,refetchAccessPeople:m})]})},Ao=({open:a,movingFolderID:r,handleClose:n,refetch:o})=>{const{showErrorNotification:e,showSuccessNotification:g}=P(),{rootFolderID:f,rootFolder:b}=he(),[l,v]=s.useState(b),[h]=We(),{data:I,loading:d}=Ve({variables:{folderID:(l==null?void 0:l.ID)||f||""},skip:!(l!=null&&l.ID)&&!f,fetchPolicy:"cache-and-network"}),{data:m,loading:S}=Qe({variables:{folderID:(l==null?void 0:l.ID)||f||""},skip:!(l!=null&&l.ID)&&!f,fetchPolicy:"cache-and-network"}),D=()=>{(l==null?void 0:l.ID)!==(b==null?void 0:b.ID)&&v(l==null?void 0:l.rootFolder)};return i(j,{open:a,onOk:async()=>{try{const{data:u}=await h({variables:{folderID:r,targetFolderID:(l==null?void 0:l.ID)||""}});g((u==null?void 0:u.moveFolder)||""),n(),o()}catch(u){e(u.message)}},onCancel:n,closable:!1,okText:"Move",title:$("div",{children:[(l==null?void 0:l.ID)!==(b==null?void 0:b.ID)&&i(B,{icon:i(qe,{}),shape:"circle",className:"mr-4",onClick:D}),(l==null?void 0:l.ID)===(b==null?void 0:b.ID)?"My Storage":l==null?void 0:l.name]}),children:d||S?i("div",{className:"h-[40rem] flex justify-center items-center",children:i(J,{size:"large"})}):i(E,{className:"max-h-[40rem] overflow-auto",itemLayout:"horizontal",dataSource:[...(I==null?void 0:I.getFoldersOfFolder)??[],...(m==null?void 0:m.getFilesByFolder)??[]],renderItem:u=>i(E.Item,{children:$(B,{type:"text",className:"w-full text-left",disabled:!!(u!=null&&u.fileType),onClick:()=>v(u),children:[u!=null&&u.fileType?i(Xe,{}):i(ho,{}),u.name]})})})})},jo=({open:a,selectedFolder:r,refetch:n,handleClose:o})=>{const{showErrorNotification:e,showSuccessNotification:g}=P(),[f,b]=s.useState((r==null?void 0:r.name)||""),[l]=Ze();return i(j,{open:a,title:"Rename Folder",onOk:async()=>{try{if(r!=null&&r.ID){const{data:h}=await l({variables:{folderID:r==null?void 0:r.ID,name:f}});g((h==null?void 0:h.renameFolder)||""),n(),o()}}catch(h){e(h.message)}},onCancel:o,children:i(ue,{value:f,onChange:h=>b(h.target.value)})})},Go=co.div`
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  border-radius: 8px;
`,{Text:_o}=N,Jo=({folders:a,selectedItem:r,handleClickFolder:n,refetch:o,isStarred:e})=>{const[g]=Ke(),[f]=Je(),{showErrorNotification:b,showSuccessNotification:l}=P(),[v,h]=s.useState(null),[I,d]=s.useState(null),[m,S]=s.useState(null),[D,y]=s.useState(!1),[u]=Ye(),[x]=eo(),t=c=>[{label:"Download",key:"1",icon:i(po,{}),onClick:()=>{y(!0),to(String(c.ID),"folders",c.name)}},...e?[]:[{label:"Move to trash",key:"2",icon:i(fo,{}),onClick:async()=>{try{await g({variables:{folderID:c.ID}}),await o(),l("Folder moved to trash successfully")}catch(p){b(p.message)}}},{label:"Share this folder",key:"3",icon:i(ao,{}),onClick:()=>{h(c)}},{label:"Add to starred",key:"4",icon:i(te,{}),onClick:async()=>{try{await u({variables:{folderID:c.ID}}),await o(),l("Folder added to starred successfully")}catch(p){b(p.message)}}},{label:"Rename",key:"5",icon:i(ro,{}),onClick:async()=>{d(c)}},{label:"Make a copy",key:"6",icon:i(no,{}),onClick:async()=>{try{const{data:p}=await f({variables:{folderID:c.ID}});p!=null&&p.makeCopyOfFolder&&(await o(),l(p==null?void 0:p.makeCopyOfFolder))}catch(p){b(p.message)}}},{label:"Move to",key:"7",icon:i(lo,{icon:so}),onClick:async()=>{S(c)}}],...e?[{label:"Remove from starred",key:"5",icon:i(te,{}),onClick:async()=>{try{const{data:p}=await x({variables:{folderID:c.ID}});l((p==null?void 0:p.unstarFolder)||""),o()}catch(p){b(p.message)}}}]:[]],R=()=>{h(null)},C=s.useMemo(()=>a.filter(c=>!c.isTrash),[a]);return s.useEffect(()=>{D?X.loading({content:"Zipping folder...",key:"zipping-folder",duration:0}):X.destroy()},[D]),$(U,{children:[i(ce,{className:"ml-7",children:C==null?void 0:C.map(c=>i(K,{menu:{items:t(c)},trigger:["contextMenu"],children:i(q,{className:"m-4",children:i(oo,{title:c.name,children:$(Go,{className:`p-3 flex flex-row items-center min-w-[17rem] max-w-[17rem] ${(r==null?void 0:r.ID)===c.ID&&r.type==="folder"?"bg-blue-100":"bg-white hover:bg-neutral-100"}`,onClick:()=>n==null?void 0:n(c),children:[i(io,{className:"text-xl mr-3 flex items-center"}),i(_o,{className:"inline-block truncate select-none font-semibold",children:c.name})]})})})},c.ID))}),!!v&&i(Lo,{open:!!v,handleClose:R,folder:v}),!!I&&i(jo,{open:!!I,selectedFolder:I,refetch:o,handleClose:()=>d(null)}),!!m&&i(Ao,{open:!!m,movingFolderID:m.ID,handleClose:()=>S(null),refetch:o})]})};export{zo as A,po as C,Jo as F,Co as L,V as R,Lo as S,T as U,ve as a,re as b,Go as c};
